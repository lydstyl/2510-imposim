<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Imposim - Simulateur d'Imp√¥t sur le Revenu</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
          Oxygen, Ubuntu, Cantarell, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
        color: #333;
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
      }

      header {
        text-align: center;
        color: white;
        margin-bottom: 30px;
      }

      header h1 {
        font-size: 2.5rem;
        margin-bottom: 10px;
        font-weight: 700;
      }

      header p {
        font-size: 1.1rem;
        opacity: 0.95;
      }

      .card {
        background: white;
        border-radius: 16px;
        padding: 30px;
        margin-bottom: 20px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
      }

      .card h2 {
        color: #667eea;
        margin-bottom: 20px;
        font-size: 1.5rem;
        border-bottom: 2px solid #667eea;
        padding-bottom: 10px;
      }

      .form-group {
        margin-bottom: 20px;
      }

      label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: #555;
      }

      input[type='number'] {
        width: 100%;
        padding: 12px 16px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 1rem;
        transition: border-color 0.3s;
      }

      input[type='number']:focus {
        outline: none;
        border-color: #667eea;
      }

      .checkbox-group {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 8px;
        margin-bottom: 20px;
      }

      input[type='checkbox'] {
        width: 20px;
        height: 20px;
        cursor: pointer;
        accent-color: #667eea;
      }

      .checkbox-group label {
        margin: 0;
        cursor: pointer;
        user-select: none;
      }

      button {
        width: 100%;
        padding: 16px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.2s, box-shadow 0.2s;
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
      }

      button:active {
        transform: translateY(0);
      }

      #results {
        display: none;
      }

      #results.visible {
        display: block;
      }

      .result-section {
        margin-bottom: 25px;
      }

      .result-section h3 {
        color: #667eea;
        margin-bottom: 12px;
        font-size: 1.2rem;
      }

      .result-line {
        display: flex;
        justify-content: space-between;
        padding: 10px 0;
        border-bottom: 1px solid #f0f0f0;
      }

      .result-line:last-child {
        border-bottom: none;
      }

      .result-label {
        color: #666;
      }

      .result-value {
        font-weight: 600;
        color: #333;
      }

      .total-result {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px;
        border-radius: 12px;
        text-align: center;
        margin-top: 20px;
      }

      .total-result h3 {
        font-size: 1.3rem;
        margin-bottom: 10px;
      }

      .total-result .amount {
        font-size: 2.5rem;
        font-weight: 700;
      }

      .synthesis {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 12px;
        margin-top: 20px;
        border-left: 4px solid #667eea;
      }

      .synthesis p {
        font-size: 1.1rem;
        line-height: 1.6;
        color: #555;
      }

      .bonus-info {
        background: #e3f2fd;
        padding: 15px;
        border-radius: 8px;
        margin-top: 15px;
        border-left: 4px solid #2196f3;
      }

      .bonus-info strong {
        color: #1976d2;
      }

      .grid-2 {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
      }

      @media (max-width: 768px) {
        header h1 {
          font-size: 2rem;
        }

        .card {
          padding: 20px;
        }

        .grid-2 {
          grid-template-columns: 1fr;
        }

        .total-result .amount {
          font-size: 2rem;
        }
      }

      .info-badge {
        display: inline-block;
        background: #e3f2fd;
        color: #1976d2;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.85rem;
        margin-left: 8px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>üíº Imposim</h1>
        <p>Simulateur d'imp√¥t sur le revenu pour freelance-investisseur</p>
      </header>

      <div class="card">
        <h2>üìä Vos revenus annuels</h2>

        <div class="form-group">
          <label for="revenuBNC">
            Revenu micro-BNC (freelance)
            <span class="info-badge">Abattement 34%</span>
          </label>
          <input
            type="number"
            id="revenuBNC"
            value="28000"
            min="0"
            step="100"
          />
        </div>

        <div class="form-group">
          <label for="revenuBIC">
            Revenu micro-BIC (location meubl√©e)
            <span class="info-badge">Abattement 50%</span>
          </label>
          <input type="number" id="revenuBIC" value="8400" min="0" step="100" />
        </div>

        <div class="form-group">
          <label for="revenuFoncier">
            Revenu micro-foncier (location nue)
            <span class="info-badge">Abattement 30%</span>
          </label>
          <input
            type="number"
            id="revenuFoncier"
            value="5600"
            min="0"
            step="100"
          />
        </div>

        <div class="form-group">
          <label for="gainsCrypto">Plus-values crypto</label>
          <input
            type="number"
            id="gainsCrypto"
            value="10000"
            min="0"
            step="100"
          />
        </div>

        <div class="form-group">
          <label for="parts">Nombre de parts fiscales</label>
          <input
            type="number"
            id="parts"
            value="2.75"
            min="1"
            max="10"
            step="0.5"
          />
        </div>

        <div class="checkbox-group">
          <input type="checkbox" id="pfuCrypto" />
          <label for="pfuCrypto"
            >Appliquer la flat tax (PFU ou Pr√©l√®vement Forfaitaire Unique 30%)
            sur les gains crypto</label
          >
        </div>

        <button onclick="calculerImpot()">üßÆ Calculer mon imp√¥t</button>
      </div>

      <div id="results" class="card">
        <h2>üìã R√©sultats d√©taill√©s</h2>

        <div class="result-section">
          <h3>1Ô∏è‚É£ Revenus bruts</h3>
          <div class="result-line">
            <span class="result-label">Micro-BNC</span>
            <span class="result-value" id="brutBNC">0 ‚Ç¨</span>
          </div>
          <div class="result-line">
            <span class="result-label">Micro-BIC</span>
            <span class="result-value" id="brutBIC">0 ‚Ç¨</span>
          </div>
          <div class="result-line">
            <span class="result-label">Micro-foncier</span>
            <span class="result-value" id="brutFoncier">0 ‚Ç¨</span>
          </div>
          <div class="result-line">
            <span class="result-label">Plus-values crypto</span>
            <span class="result-value" id="brutCrypto">0 ‚Ç¨</span>
          </div>
          <div class="result-line" style="font-weight: 600; color: #667eea">
            <span class="result-label">Total revenus bruts</span>
            <span class="result-value" id="totalBrut">0 ‚Ç¨</span>
          </div>
        </div>

        <div class="result-section">
          <h3>2Ô∏è‚É£ Abattements appliqu√©s</h3>
          <div class="result-line">
            <span class="result-label">BNC (34%)</span>
            <span class="result-value" id="abattementBNC">0 ‚Ç¨</span>
          </div>
          <div class="result-line">
            <span class="result-label">BIC (50%)</span>
            <span class="result-value" id="abattementBIC">0 ‚Ç¨</span>
          </div>
          <div class="result-line">
            <span class="result-label">Foncier (30%)</span>
            <span class="result-value" id="abattementFoncier">0 ‚Ç¨</span>
          </div>
        </div>

        <div class="result-section">
          <h3>3Ô∏è‚É£ Revenus imposables</h3>
          <div class="result-line">
            <span class="result-label">BNC imposable</span>
            <span class="result-value" id="imposableBNC">0 ‚Ç¨</span>
          </div>
          <div class="result-line">
            <span class="result-label">BIC imposable</span>
            <span class="result-value" id="imposableBIC">0 ‚Ç¨</span>
          </div>
          <div class="result-line">
            <span class="result-label">Foncier imposable</span>
            <span class="result-value" id="imposableFoncier">0 ‚Ç¨</span>
          </div>
          <div class="result-line">
            <span class="result-label">Crypto imposable (au bar√®me)</span>
            <span class="result-value" id="imposableCrypto">0 ‚Ç¨</span>
          </div>
          <div class="result-line" style="font-weight: 600; color: #667eea">
            <span class="result-label">Total imposable</span>
            <span class="result-value" id="totalImposable">0 ‚Ç¨</span>
          </div>
        </div>

        <div class="result-section">
          <h3>4Ô∏è‚É£ Cotisations et pr√©l√®vements sociaux</h3>
          <div class="result-line">
            <span class="result-label">Cotisations sociales BNC (22%)
              <span class="info-badge" style="background: #e8f5e9; color: #2e7d32;">D√©j√† pay√© √† l'URSSAF</span>
            </span>
            <span class="result-value" id="cotisationsBNC">0 ‚Ç¨</span>
          </div>
          <div class="result-line">
            <span class="result-label">Pr√©l√®vements sociaux BIC (17,2%)</span>
            <span class="result-value" id="prelevementsBIC">0 ‚Ç¨</span>
          </div>
          <div class="result-line">
            <span class="result-label"
              >Pr√©l√®vements sociaux Foncier (17,2%)</span
            >
            <span class="result-value" id="prelevementsFoncier">0 ‚Ç¨</span>
          </div>
          <div class="result-line" id="prelevementsCryptoLine">
            <span class="result-label"
              >Pr√©l√®vements sociaux Crypto (17,2%)</span
            >
            <span class="result-value" id="prelevementsCrypto">0 ‚Ç¨</span>
          </div>
          <div class="result-line" style="font-weight: 600; color: #667eea">
            <span class="result-label"
              >Total cotisations et pr√©l√®vements sociaux</span
            >
            <span class="result-value" id="totalCotisations">0 ‚Ç¨</span>
          </div>
        </div>

        <div class="result-section">
          <h3>5Ô∏è‚É£ Application du bar√®me progressif</h3>
          <div class="result-line">
            <span class="result-label">Quotient familial (revenu / parts)</span>
            <span class="result-value" id="quotient">0 ‚Ç¨</span>
          </div>
          <div id="tranchesDetail"></div>
          <div class="result-line" style="font-weight: 600; color: #667eea">
            <span class="result-label">Imp√¥t sur 1 part</span>
            <span class="result-value" id="impotUnePart">0 ‚Ç¨</span>
          </div>
          <div class="result-line" style="font-weight: 600; color: #667eea">
            <span class="result-label"
              >Imp√¥t brut (√ó <span id="partsMultiplier">2</span> parts)</span
            >
            <span class="result-value" id="impotBrut">0 ‚Ç¨</span>
          </div>
        </div>

        <div class="result-section" id="pfuSection" style="display: none">
          <h3>6Ô∏è‚É£ Flat tax crypto (PFU)</h3>
          <div class="result-line">
            <span class="result-label">Montant brut crypto</span>
            <span class="result-value" id="pfuMontantBrut">0 ‚Ç¨</span>
          </div>
          <div class="result-line">
            <span class="result-label">Imp√¥t sur le revenu (12,8%)</span>
            <span class="result-value" id="pfuIR">0 ‚Ç¨</span>
          </div>
          <div class="result-line">
            <span class="result-label">Pr√©l√®vements sociaux (17,2%)</span>
            <span class="result-value" id="pfuPS">0 ‚Ç¨</span>
          </div>
          <div class="result-line" style="font-weight: 600; color: #667eea">
            <span class="result-label">Total PFU 30%</span>
            <span class="result-value" id="pfuAmount">0 ‚Ç¨</span>
          </div>
          <div class="bonus-info" style="margin-top: 15px">
            <strong>‚ÑπÔ∏è R√©gime appliqu√© :</strong> PFU (Pr√©l√®vement Forfaitaire
            Unique) = 12,8% IR + 17,2% pr√©l√®vements sociaux ‚Üí total 30%
          </div>
        </div>

        <div class="result-section" id="baremeSection" style="display: none">
          <h3>6Ô∏è‚É£ Pr√©l√®vements sociaux sur crypto</h3>
          <div class="result-line">
            <span class="result-label">Montant brut crypto</span>
            <span class="result-value" id="baremeMontantBrut">0 ‚Ç¨</span>
          </div>
          <div class="result-line">
            <span class="result-label">Pr√©l√®vements sociaux (17,2%)</span>
            <span class="result-value" id="baremePS">0 ‚Ç¨</span>
          </div>
          <div class="bonus-info" style="margin-top: 15px">
            <strong>‚ÑπÔ∏è R√©gime appliqu√© :</strong> Les gains crypto sont impos√©s
            au bar√®me progressif (d√©j√† inclus au point 4Ô∏è‚É£) + 17,2% de
            pr√©l√®vements sociaux sur la plus-value
          </div>
        </div>

        <div class="total-result" style="background: linear-gradient(135deg, #43a047 0%, #2e7d32 100%);">
          <h3>üí≥ Imp√¥t sur le revenu √† payer</h3>
          <div style="font-size: 1.8rem; font-weight: 700; margin-bottom: 5px;" id="totalImpotRevenu">0 ‚Ç¨</div>
          <div style="font-size: 1rem; opacity: 0.9;">
            (IR + pr√©l√®vements sociaux BIC/Foncier/Crypto + PFU crypto si applicable)
          </div>
          <div style="font-size: 1.2rem; margin-top: 10px; opacity: 0.95" id="pourcentageBrutIR">
            0% des revenus bruts
          </div>
        </div>

        <div class="total-result">
          <h3>üí∞ Total des charges fiscales et sociales</h3>
          <div class="amount" id="totalImpot">0 ‚Ç¨</div>
          <div style="font-size: 1rem; opacity: 0.9; margin-top: 5px;">
            (Incluant les cotisations URSSAF d√©j√† pay√©es)
          </div>
          <div style="font-size: 1.2rem; margin-top: 10px; opacity: 0.95" id="pourcentageBrut">
            0% des revenus bruts
          </div>
        </div>

        <div class="synthesis">
          <p id="synthesisText"></p>
        </div>

        <div class="bonus-info" id="bonusInfo">
          <strong>üí° Astuce :</strong> <span id="bonusText"></span>
        </div>
      </div>
    </div>

    <script>
      // Bar√®me IR 2025
      const bareme = [
        { max: 11497, taux: 0 },
        { max: 29315, taux: 0.11 },
        { max: 83823, taux: 0.3 },
        { max: 180294, taux: 0.41 },
        { max: Infinity, taux: 0.45 }
      ]

      function formatEuro(montant) {
        return (
          new Intl.NumberFormat('fr-FR', {
            minimumFractionDigits: 2,
            maximumFractionDigits: 2
          }).format(montant) + ' ‚Ç¨'
        )
      }

      function calculerImpotProgressif(revenuImposable) {
        let impot = 0
        let revenuRestant = revenuImposable
        let tranchesPrecedentes = 0
        const details = []

        for (let i = 0; i < bareme.length; i++) {
          const tranche = bareme[i]
          const plafondTranche = tranche.max
          const montantTranche = Math.min(
            revenuRestant,
            plafondTranche - tranchesPrecedentes
          )

          if (montantTranche > 0) {
            const impotTranche = montantTranche * tranche.taux
            impot += impotTranche

            details.push({
              montant: montantTranche,
              taux: tranche.taux,
              impot: impotTranche,
              de: tranchesPrecedentes,
              a: Math.min(plafondTranche, revenuImposable)
            })

            revenuRestant -= montantTranche
            tranchesPrecedentes = plafondTranche

            if (revenuRestant <= 0) break
          }
        }

        return { impot, details }
      }

      function calculerRevenuMaxPourZeroImpot(parts) {
        // Pour 0‚Ç¨ d'imp√¥t, on ne doit pas d√©passer la premi√®re tranche
        // Avec le quotient familial : revenu_total = quotient √ó parts
        return bareme[0].max * parts
      }

      function calculerImpot() {
        // R√©cup√©ration des valeurs
        const revenuBNC =
          parseFloat(document.getElementById('revenuBNC').value) || 0
        const revenuBIC =
          parseFloat(document.getElementById('revenuBIC').value) || 0
        const revenuFoncier =
          parseFloat(document.getElementById('revenuFoncier').value) || 0
        const gainsCrypto =
          parseFloat(document.getElementById('gainsCrypto').value) || 0
        const parts = parseFloat(document.getElementById('parts').value) || 1
        const pfuCrypto = document.getElementById('pfuCrypto').checked

        // Affichage des revenus bruts
        const totalBrut = revenuBNC + revenuBIC + revenuFoncier + gainsCrypto

        document.getElementById('brutBNC').textContent = formatEuro(revenuBNC)
        document.getElementById('brutBIC').textContent = formatEuro(revenuBIC)
        document.getElementById('brutFoncier').textContent =
          formatEuro(revenuFoncier)
        document.getElementById('brutCrypto').textContent =
          formatEuro(gainsCrypto)
        document.getElementById('totalBrut').textContent =
          formatEuro(totalBrut)

        // Calcul des abattements
        const abattementBNC = revenuBNC * 0.34
        const abattementBIC = revenuBIC * 0.5
        const abattementFoncier = revenuFoncier * 0.3

        document.getElementById('abattementBNC').textContent =
          formatEuro(abattementBNC)
        document.getElementById('abattementBIC').textContent =
          formatEuro(abattementBIC)
        document.getElementById('abattementFoncier').textContent =
          formatEuro(abattementFoncier)

        // Calcul des revenus imposables
        const imposableBNC = revenuBNC - abattementBNC
        const imposableBIC = revenuBIC - abattementBIC
        const imposableFoncier = revenuFoncier - abattementFoncier

        // Si PFU est coch√©e, les crypto ne sont pas au bar√®me
        const imposableCrypto = pfuCrypto ? 0 : gainsCrypto

        document.getElementById('imposableBNC').textContent =
          formatEuro(imposableBNC)
        document.getElementById('imposableBIC').textContent =
          formatEuro(imposableBIC)
        document.getElementById('imposableFoncier').textContent =
          formatEuro(imposableFoncier)
        document.getElementById('imposableCrypto').textContent =
          formatEuro(imposableCrypto)

        // Total imposable
        const totalImposable =
          imposableBNC + imposableBIC + imposableFoncier + imposableCrypto
        document.getElementById('totalImposable').textContent =
          formatEuro(totalImposable)

        // Calcul des cotisations et pr√©l√®vements sociaux
        const cotisationsBNC = imposableBNC * 0.22
        const prelevementsBIC = imposableBIC * 0.172
        const prelevementsFoncier = imposableFoncier * 0.172

        // Pour crypto : si PFU, les pr√©l√®vements sociaux sont inclus dans le PFU
        // Si bar√®me, on les calcule ici
        let prelevementsCrypto = 0
        if (!pfuCrypto && gainsCrypto > 0) {
          prelevementsCrypto = gainsCrypto * 0.172
          document.getElementById('prelevementsCryptoLine').style.display =
            'flex'
        } else {
          document.getElementById('prelevementsCryptoLine').style.display =
            'none'
        }

        const totalCotisations =
          cotisationsBNC +
          prelevementsBIC +
          prelevementsFoncier +
          prelevementsCrypto

        document.getElementById('cotisationsBNC').textContent =
          formatEuro(cotisationsBNC)
        document.getElementById('prelevementsBIC').textContent =
          formatEuro(prelevementsBIC)
        document.getElementById('prelevementsFoncier').textContent =
          formatEuro(prelevementsFoncier)
        document.getElementById('prelevementsCrypto').textContent =
          formatEuro(prelevementsCrypto)
        document.getElementById('totalCotisations').textContent =
          formatEuro(totalCotisations)

        // Quotient familial
        const quotient = totalImposable / parts
        document.getElementById('quotient').textContent = formatEuro(quotient)

        // Calcul de l'imp√¥t progressif
        const { impot: impotUnePart, details } =
          calculerImpotProgressif(quotient)

        // Affichage des tranches
        let tranchesHTML = ''
        details.forEach((detail, index) => {
          const tauxPourcent = (detail.taux * 100).toFixed(0)
          tranchesHTML += `
                    <div class="result-line" style="font-size: 0.9rem; color: #777;">
                        <span class="result-label">Tranche ${
                          index + 1
                        } : ${formatEuro(
            detail.montant
          )} √ó ${tauxPourcent}%</span>
                        <span class="result-value">${formatEuro(
                          detail.impot
                        )}</span>
                    </div>
                `
        })
        document.getElementById('tranchesDetail').innerHTML = tranchesHTML

        document.getElementById('impotUnePart').textContent =
          formatEuro(impotUnePart)
        document.getElementById('partsMultiplier').textContent = parts

        // Imp√¥t brut (multipli√© par le nombre de parts)
        const impotBrut = impotUnePart * parts
        document.getElementById('impotBrut').textContent = formatEuro(impotBrut)

        // Calcul des imp√¥ts crypto
        let impotCrypto = 0

        if (gainsCrypto > 0) {
          if (pfuCrypto) {
            // Mode PFU : 12,8% IR + 17,2% pr√©l√®vements sociaux = 30%
            const pfuIR = gainsCrypto * 0.128
            const pfuPS = gainsCrypto * 0.172
            const pfuTotal = pfuIR + pfuPS

            document.getElementById('pfuMontantBrut').textContent =
              formatEuro(gainsCrypto)
            document.getElementById('pfuIR').textContent = formatEuro(pfuIR)
            document.getElementById('pfuPS').textContent = formatEuro(pfuPS)
            document.getElementById('pfuAmount').textContent =
              formatEuro(pfuTotal)

            document.getElementById('pfuSection').style.display = 'block'
            document.getElementById('baremeSection').style.display = 'none'

            impotCrypto = pfuTotal
          } else {
            // Mode bar√®me : crypto inclus dans le revenu imposable
            // L'imp√¥t sur le revenu est d√©j√† calcul√© dans le bar√®me progressif (point 5)
            // Les pr√©l√®vements sociaux sont d√©j√† calcul√©s dans la section 4 (cotisations et pr√©l√®vements sociaux)

            document.getElementById('baremeMontantBrut').textContent =
              formatEuro(gainsCrypto)
            document.getElementById('baremePS').textContent =
              formatEuro(prelevementsCrypto)

            document.getElementById('pfuSection').style.display = 'none'
            document.getElementById('baremeSection').style.display = 'block'

            // L'imp√¥t crypto = 0 car tout est d√©j√† compt√© ailleurs
            // (l'IR est d√©j√† dans impotBrut, les PS sont dans totalCotisations)
            impotCrypto = 0
          }
        } else {
          document.getElementById('pfuSection').style.display = 'none'
          document.getElementById('baremeSection').style.display = 'none'
        }

        // Total imp√¥t sur le revenu √† payer (sans les cotisations BNC d√©j√† pay√©es √† l'URSSAF)
        const prelevementsSociauxSansURSSAF = prelevementsBIC + prelevementsFoncier + prelevementsCrypto
        const totalImpotRevenu = impotBrut + prelevementsSociauxSansURSSAF + impotCrypto

        document.getElementById('totalImpotRevenu').textContent =
          formatEuro(totalImpotRevenu)

        const pourcentageBrutIR = totalBrut > 0 ? ((totalImpotRevenu / totalBrut) * 100).toFixed(2) : 0
        document.getElementById('pourcentageBrutIR').textContent =
          `${pourcentageBrutIR}% des revenus bruts`

        // Total final : tout inclus (pour information, incluant cotisations URSSAF)
        const totalImpot = impotBrut + totalCotisations + impotCrypto
        document.getElementById('totalImpot').textContent =
          formatEuro(totalImpot)

        // Pourcentage par rapport aux revenus bruts
        const pourcentageBrut = totalBrut > 0 ? ((totalImpot / totalBrut) * 100).toFixed(2) : 0
        document.getElementById('pourcentageBrut').textContent =
          `${pourcentageBrut}% des revenus bruts`

        // Synth√®se
        const revenuTotal = revenuBNC + revenuBIC + revenuFoncier + gainsCrypto
        const tauxEffectif =
          revenuTotal > 0 ? ((totalImpot / revenuTotal) * 100).toFixed(2) : 0

        let synthesisText = `Avec ${parts} part${parts > 1 ? 's' : ''} fiscale${
          parts > 1 ? 's' : ''
        } et un revenu total de ${formatEuro(
          revenuTotal
        )}, le montant total √† payer est de ${formatEuro(
          totalImpot
        )} (incluant ${formatEuro(
          impotBrut
        )} d'imp√¥t sur le revenu et ${formatEuro(
          totalCotisations
        )} de cotisations/pr√©l√®vements sociaux`

        if (gainsCrypto > 0 && pfuCrypto) {
          synthesisText += `, plus ${formatEuro(impotCrypto)} de PFU crypto`
        }

        synthesisText += `). Votre taux global effectif est de ${tauxEffectif}%.`

        document.getElementById('synthesisText').textContent = synthesisText

        // Bonus : revenu maximum pour 0‚Ç¨ d'imp√¥t
        const revenuMaxZeroImpot = calculerRevenuMaxPourZeroImpot(parts)
        const revenuNetMaxZeroImpot = revenuMaxZeroImpot // Approximation (avant abattements)

        document.getElementById('bonusText').textContent = `Avec ${parts} part${
          parts > 1 ? 's' : ''
        }, vous pouvez avoir jusqu'√† environ ${formatEuro(
          revenuMaxZeroImpot
        )} de revenu imposable (apr√®s abattements) sans payer d'imp√¥t sur le revenu.`

        // Affichage des r√©sultats
        document.getElementById('results').classList.add('visible')
        document
          .getElementById('results')
          .scrollIntoView({ behavior: 'smooth', block: 'nearest' })
      }

      // Permettre le calcul avec la touche Entr√©e
      document.addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
          calculerImpot()
        }
      })
    </script>
  </body>
</html>
